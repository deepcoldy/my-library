webpackJsonp([1],{"+Mcf":function(e,t){},"/eQD":function(e,t){},"5LVj":function(e,t){},"5kWq":function(e,t){},"88P/":function(e,t){},"Cj3+":function(e,t){},FHjr:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n("tIUf");var a=n("qCpv"),o=n.n(a),i=(n("lrMw"),n("7YS2")),r=n.n(i),c=(n("y+mr"),n("3JdW")),s=n.n(c),l=(n("XDqQ"),n("Axha")),u=n.n(l),d=(n("f1Vh"),n("ZQVe")),p=n.n(d),f=(n("nOaS"),n("pIDD")),h=(n("XmAh"),n("il3B")),m=(n("eqfM"),n("/QYm")),v=(n("FO5P"),n("woHG")),b=(n("i0mo"),n("Hkar")),_=(n("OWWB"),n("1fWZ")),g=(n("3Lne"),n("SSsa")),k=(n("I4j4"),n("7fQT")),w=(n("gi6D"),n("XPjg")),q=(n("MY4N"),n("0zAV")),y=n("7+uW"),x={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var $=n("VU/8")({name:"App"},x,!1,function(e){n("+Mcf")},null,null).exports,C=n("/ocq"),B=(n("qONS"),n("UQTY")),D=n.n(B),F=n("mtWM"),L=n.n(F),V={data:function(){return{account:"",password:"",openid:""}},created:function(){console.log(this.$route),this.$route.query&&this.$route.query.openid&&(this.openid=this.$route.query.openid)},components:{Indicator:D.a,Field:q.a,Cell:_.a,CellGroup:b.a,Button:g.a,NavBar:v.a,Toast:m.a,Dialog:h.a},methods:{goRegister:function(){this.$router.push({name:"Register",query:{openid:this.openid}})},login:function(){var e=this;this.account&&this.password?L()({method:"POST",headers:{"content-type":"application/json"},data:{account:this.account,password:this.password,open_id:this.openid},url:"api/login"}).then(function(t){t.data;e.$router.push({name:"Profile"})}).catch(function(){h.a.alert({title:e.openid?"账号或密码错误，绑定失败":"账号或密码错误，登录失败"})}):m.a.fail("请填写完整")},wechatLogin:function(){location.href="http://library.iscode.cn/api/auth/weixin"}}},I={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("van-nav-bar",{attrs:{title:e.openid?"绑定账号":"登录","right-text":"注册"},on:{"click-right":e.goRegister}}),e._v(" "),n("van-cell-group",[n("van-field",{attrs:{label:"账号",icon:"clear",placeholder:"请输入用户名",required:""},on:{"click-icon":function(t){e.account=""}},model:{value:e.account,callback:function(t){e.account=t},expression:"account"}}),e._v(" "),n("van-field",{attrs:{type:"password",label:"密码",placeholder:"请输入密码",required:""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),e._v(" "),n("van-button",{staticClass:"button",attrs:{type:"primary"},on:{click:e.login}},[e._v(e._s(e.openid?"绑定微信":"登录"))]),e._v(" "),e.openid?e._e():n("van-button",{staticClass:"button",attrs:{type:"default"},on:{click:e.wechatLogin}},[e._v("微信登录")])],1)},staticRenderFns:[]};var R=n("VU/8")(V,I,!1,function(e){n("a0lt")},"data-v-008cf3ea",null).exports,U={data:function(){return{account:"",name:"",password:"",number:""}},components:{Indicator:D.a,Field:q.a,Cell:_.a,CellGroup:b.a,Button:g.a,NavBar:v.a,Toast:m.a,Dialog:h.a},methods:{backLogin:function(){this.$router.push({name:"Login"})},register:function(){var e=this;this.account&&this.name&&this.password&&this.number?L.a.post("api/register",{account:this.account,name:this.name,password:this.password,number:this.number}).then(function(t){m.a.success("注册成功，请登录"),e.$router.push({name:"Login",query:{openid:e.$route.query.openid}})}).catch(function(){h.a.alert({title:"注册失败"})}):m.a.fail("请填写完整")}}},j={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("van-nav-bar",{attrs:{title:"注册","left-text":"返回","left-arrow":""},on:{"click-left":e.backLogin}}),e._v(" "),n("van-cell-group",[n("van-field",{attrs:{label:"账号",icon:"clear",placeholder:"请输入用户名",required:""},on:{"click-icon":function(t){e.account=""}},model:{value:e.account,callback:function(t){e.account=t},expression:"account"}}),e._v(" "),n("van-field",{attrs:{label:"姓名",icon:"clear",placeholder:"请输入姓名",required:""},on:{"click-icon":function(t){e.name=""}},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),e._v(" "),n("van-field",{attrs:{label:"学号",icon:"clear",placeholder:"请输入学号",required:""},on:{"click-icon":function(t){e.number=""}},model:{value:e.number,callback:function(t){e.number=t},expression:"number"}}),e._v(" "),n("van-field",{attrs:{type:"password",label:"密码",placeholder:"请输入密码",required:""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),e._v(" "),n("van-button",{staticClass:"button",attrs:{type:"primary"},on:{click:e.register}},[e._v("注册")])],1)},staticRenderFns:[]};var N=n("VU/8")(U,j,!1,function(e){n("88P/")},"data-v-2f2c5c36",null).exports,P={data:function(){return{profile:{name:"",student_number:"",borrow_times:""}}},components:{Cell:_.a,CellGroup:b.a,Loading:f.a},methods:{init:function(){var e=this;L.a.get("api/profile").then(function(t){var n=t.data;"unbind"!==n.status?e.profile={name:n.name,student_number:n.student_number,borrow_times:n.borrow_times.toString(),bind_weixin:!!n.open_id}:h.a.alert({message:"微信登陆成功！您还未绑定账号，请前去绑定。"}).then(function(){e.$router.push({name:"Login",query:{openid:n.open_id}})})})},bindWechat:function(){location.href="http://library.iscode.cn/api/auth/weixin"}},created:function(){this.init()}},S={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("van-nav-bar",{attrs:{title:"个人信息"}}),e._v(" "),e.profile.name?n("van-cell-group",[n("van-cell",{attrs:{title:"姓名",value:e.profile.name}}),e._v(" "),n("van-cell",{attrs:{title:"学号",value:e.profile.student_number}}),e._v(" "),n("van-cell",{attrs:{title:"总借书次数",value:e.profile.borrow_times}}),e._v(" "),n("van-cell",{attrs:{title:"微信",value:e.profile.bind_weixin?"已绑定":"点击绑定"},on:{click:e.bindWechat}})],1):e._e(),e._v(" "),e.profile.name?e._e():n("van-loading",{attrs:{color:"white"}})],1)},staticRenderFns:[]},W=n("VU/8")(P,S,!1,null,null,null).exports,M={data:function(){return{search:"",result:[]}},components:{Indicator:D.a},mounted:function(){console.log(this.$route),this.search=this.$route.query.q},watch:{search:function(e){this.$router.replace({path:"/search",query:{q:e}}),e&&this.searchBooks()}},methods:{searchBooks:function(){var e=this;D.a.open(),L.a.get("api/search",{params:{q:this.search}}).then(function(t){D.a.close(),console.log(t),e.result=t.data}).catch(function(e){D.a.close(),console.log(e)})},goDetail:function(){console.log(this.router),this.router.push("BookDetail")}}},T={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("mt-search",{attrs:{placeholder:"请输入要查询的书名或作者"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[n("div",{staticClass:"blank"}),e._v(" "),e._l(e.result,function(e,t){return n("mt-cell",{key:"cell"+t,attrs:{to:"/BookDetail?id="+e.id,title:e.name,label:e.writer,"is-link":""}})}),e._v(" "),e.result.length?e._e():n("div",{staticClass:"no-result"},[e._v("暂无查询结果")])],2)],1)},staticRenderFns:[]};var A=n("VU/8")(M,T,!1,function(e){n("FHjr")},"data-v-386d186a",null).exports,O={data:function(){return{id:1,book:{}}},components:{Panel:k.a,Button:g.a},methods:{init:function(){var e=this;D.a.open(),L.a.get("api/search/detail",{params:{id:this.id}}).then(function(t){var n=t.data;D.a.close(),e.book={name:n.name,writer:n.writer,score:Number(n.score),publisher:n.publisher,price:Number(n.price).toFixed(2)+"元",available_number:n.available_number,total_number:n.total_number}}).catch(function(e){D.a.close(),console.log(e)})}},created:function(){this.id=this.$route.query.id,this.init()}},Q={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("van-panel",{attrs:{title:e.book.name,desc:e.book.writer,status:e.book.available_number?"可借，剩余"+e.book.available_number+"本":"已借空"}},[n("div",{staticClass:"content"},[n("div",[e._v("出版社："+e._s(e.book.publisher))]),e._v(" "),n("div",[e._v("馆藏："+e._s(e.book.total_number)+"本")]),e._v(" "),n("div",[e._v("价格："+e._s(e.book.price))]),e._v(" "),n("van-rate",{model:{value:e.book.score,callback:function(t){e.$set(e.book,"score",t)},expression:"book.score"}})],1),e._v(" "),n("div",{staticClass:"footer",attrs:{slot:"footer"},slot:"footer"},[n("van-button",{attrs:{size:"small",type:"primary"}},[e._v("预约借阅")])],1)])},staticRenderFns:[]};var E=n("VU/8")(O,Q,!1,function(e){n("rfiI")},"data-v-b81f414e",null).exports;y.default.use(C.a);var G=new C.a({routes:[{path:"/",name:"Login",component:R},{path:"/register",name:"Register",component:N},{path:"/profile",name:"Profile",component:W},{path:"/search",name:"Search",component:A},{path:"/BookDetail",name:"BookDetail",component:E}]});y.default.use(q.a),y.default.use(w.a),y.default.use(k.a),y.default.use(g.a),y.default.use(_.a),y.default.use(b.a),y.default.use(v.a),y.default.use(m.a),y.default.use(h.a),y.default.use(f.a),y.default.config.productionTip=!1,y.default.component(p.a.name,p.a),y.default.component(u.a.name,u.a),y.default.component(s.a.name,s.a),y.default.component(r.a.name,r.a),y.default.component(o.a.name,o.a),new y.default({el:"#app",router:G,components:{App:$},template:"<App/>"})},ULTG:function(e,t){},XDqQ:function(e,t){},ZmGI:function(e,t){},a0lt:function(e,t){},f1Vh:function(e,t){},f4F5:function(e,t){},joTY:function(e,t){},lrMw:function(e,t){},qONS:function(e,t){},rfiI:function(e,t){},tIUf:function(e,t){},wA3Z:function(e,t){},"y+mr":function(e,t){},znX2:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.d412ee56fb40815ae1f6.js.map